# CheckCheck 그룹 기능 개선 계획

## 목차
1. [코인 시스템 도입](#1-코인-시스템-도입)
2. [습관 구조 개편](#2-습관-구조-개편)
3. [그룹 권한 시스템](#3-그룹-권한-시스템)
4. [그룹 티어 & 확장](#4-그룹-티어--확장)
5. [그룹 통계 시스템](#5-그룹-통계-시스템)
6. [구현 우선순위](#6-구현-우선순위)

---

## 1. 코인 시스템 도입

### 핵심 콘셉트
**"디지털 용돈 시스템"** - 가족 내 실생활 보상 체계를 앱에 구현

**목적**:
- 엄마가 자식에게 심부름 시키고 용돈 주는 개념을 디지털화
- 앱을 일상생활에 자연스럽게 녹이기
- 습관 형성에 실질적인 동기부여 제공

### 코인 획득 방법

#### 1. 개인 습관 달성
- 연속 7일 유지 시 1코인 자동 지급
- 시스템이 자동으로 보상

#### 2. 그룹 태스크 완료
- 심부름, 집안일 등 완료 시 설정된 코인 지급
- 태스크 생성 시 코인 금액 설정 가능
- 완료 후 즉시 또는 승인 후 지급

#### 3. 그룹 챌린지 (추후 구현)
- 목표 달성 시 보상
- 전원 달성형, 개인 경쟁형, 랭킹형 등

#### 4. 그룹원 간 직접 선물
- 응원, 감사의 의미로 코인 전송
- 메시지 첨부 가능

### 코인 사용처

#### Phase 1 (현재 구현)
- 그룹원끼리 주고받기만 가능
- 코인 내역 확인
- 잔액 표시

#### Phase 2 (추후)
- 인앱 리워드 (프로필 꾸미기, 이모티콘)
- 그룹 챌린지 참가비

#### Phase 3 (수익화)
- 실물 쿠폰 교환 (치킨, 커피 등)
- 코인 충전 기능 (실제 결제)
- 리워드 광고 시청으로 코인 획득

### 데이터 구조

```kotlin
// 코인 지갑
data class CoinWallet(
    val userId: String,
    val familyCoins: Int = 0,      // 가족/그룹 내에서 받은 코인
    val rewardCoins: Int = 0,      // 시스템이 지급한 코인
    val totalEarned: Int = 0,      // 누적 획득
    val totalSpent: Int = 0,       // 누적 사용
    val lastUpdated: Timestamp
)

// 코인 거래 내역
data class CoinTransaction(
    val id: String,
    val fromUserId: String,        // "system" 또는 userId
    val toUserId: String,
    val amount: Int,
    val type: TransactionType,
    val relatedTaskId: String? = null,
    val relatedHabitId: String? = null,
    val message: String? = null,
    val timestamp: Timestamp
)

enum class TransactionType {
    HABIT_REWARD,          // 습관 연속 달성 보상
    TASK_COMPLETION,       // 태스크 완료 보상
    CHALLENGE_REWARD,      // 챌린지 달성 보상
    GIFT,                  // 그룹원 간 선물
    COUPON_PURCHASE,       // 쿠폰 구매
    COIN_CHARGE,           // 코인 충전
    AD_REWARD              // 광고 시청 보상
}
```

### UI 구성

```
[코인 지갑 화면]
┌─────────────────────────────────────┐
│ 💰 내 코인                           │
│                                      │
│ 총 코인: 125                         │
│                                      │
│ 📊 코인 내역                          │
│ ────────────────────────────────────│
│ 오늘                                 │
│ + 3💰  방 청소 완료                  │
│        from 엄마                     │
│                                      │
│ 어제                                 │
│ + 1💰  아침 운동 7일 연속 달성        │
│        from 시스템                   │
│ - 5💰  동생에게 선물                 │
│        to 동생                       │
│                                      │
│ [그룹원에게 선물하기]                │
└─────────────────────────────────────┘
```

### 코인 권한 관리

```kotlin
data class GroupSettings(
    // 코인 관련 설정
    val maxCoinPerTask: Int? = null,           // 태스크당 최대 코인 제한
    val onlyAdminCanSetCoin: Boolean = false,  // 코인 설정 권한 (관리자만)
    val requireCoinApproval: Boolean = false,  // 코인 지급 승인 필요 여부
    val allowMemberGift: Boolean = true        // 멤버 간 선물 허용
)
```

**소규모 가족**: 제한 없이 자유롭게  
**대규모 그룹**: 관리자만 코인 설정 가능, 남발 방지

---

## 2. 습관 구조 개편

### 기존 구조의 문제점

**문제 1**: 개인 습관 vs 그룹 내 개인 습관 중복
- 용도가 불명확
- 사용자 혼란

**문제 2**: 그룹 내 개인 습관이 챌린지와 유사
- 각자 다른 습관을 하면 → 그냥 구경?
- 같은 습관을 하면 → 챌린지와 차이?

### 새로운 구조

#### 개인 영역
1. **개인 습관**
    - 완전히 개인적인 습관 관리
    - 7일 연속 달성 시 1코인 자동 지급
    - 그룹과 독립적

2. **개인 태스크**
    - "나만의 공간" 기능
    - 개인 할 일 관리

#### 그룹 영역

```
[그룹 화면 구성]
1. 오늘의 달성 현황
2. 그룹 습관 (함께 하는 습관)
3. 그룹 할일 (단발성 태스크)
4. 그룹원 습관 (신규 추가) 👈
```

### 그룹원 습관 (신규 기능)

**콘셉트**: "아빠가 요즘 뭐 하나?" 궁금할 때 확인

**작동 방식**:
1. 개인 습관 생성 시 "그룹에 공유" 토글 선택
2. 공유된 습관만 그룹원들이 볼 수 있음
3. 비공개 습관은 완전히 개인 영역에만
4. 수정/삭제는 본인만 가능

**UI 예시**:
```
[그룹원 습관 섹션]
┌─────────────────────────────────────┐
│ 👨 아빠          👩 엄마          👦 나  │
│ 3개 습관 진행중   2개 습관 진행중   1개 습관 진행중│
└─────────────────────────────────────┘

[아빠 카드 클릭 시]
┌─────────────────────────────────────┐
│ 아빠의 습관                           │
│                                      │
│ 🏃 아침 운동하기                      │
│ ●●●●●○○  5일 연속                   │
│ 이번 주 달성률: 71%                   │
│                                      │
│ 📚 독서하기                           │
│ ●●○○○○○  2일 연속                   │
│ 이번 주 달성률: 29%                   │
│                                      │
│ 💧 물 2L 마시기                       │
│ ●●●●●●●  7일 연속 🎉                │
│ 이번 주 달성률: 100%                  │
│                                      │
│ [응원하기 👏]                         │
└─────────────────────────────────────┘
```

### 데이터 구조

```kotlin
data class Habit(
    val id: String,
    val userId: String,
    val title: String,
    val description: String?,
    
    // 공유 설정
    val isSharedWithGroup: Boolean = false,     // 그룹 공유 여부
    val sharedGroupIds: List<String> = emptyList(),  // 공유된 그룹 목록
    
    // 기존 필드들
    val frequency: HabitFrequency,
    val reminderTime: Time?,
    val startDate: Timestamp,
    val streak: Int,
    val completions: List<Timestamp>,
    // ...
)

// 개인 습관 생성/수정 화면
data class HabitFormState(
    val title: String,
    val description: String,
    // ...
    val shareWithGroups: List<String> = emptyList()  // 공유할 그룹 선택
)
```

### 상호작용 방식

#### Phase 1 (최소주의적 접근 - 추천)

**제공하는 기능**:
- ✅ 연속 기록 보기
- ✅ 달성률 통계
- ✅ 간단한 응원 이모지 (👏, 🔥, 💪, ❤️)
- ✅ 응원 시 푸시 알림 전송

**제공하지 않는 기능** (나중에):
- ❌ 사진 인증
- ❌ 댓글 기능
- ❌ 상세한 메모

**이유**:
- CheckCheck = 습관 추적 도구, SNS 아님
- 가족/소그룹은 과도한 기능 불필요
- 간단할수록 지속 사용률 높음
- 코인 시스템이 이미 충분한 동기부여

```kotlin
// 응원 기능
data class HabitCheer(
    val id: String,
    val habitId: String,
    val fromUserId: String,
    val toUserId: String,
    val emoji: String,              // 👏, 🔥, 💪, ❤️
    val timestamp: Timestamp
)

// 응원 버튼 클릭 시
fun sendCheer(habitId: String, toUserId: String, emoji: String) {
    // 1. Firestore에 저장
    saveCheer(habitId, toUserId, emoji)
    
    // 2. FCM 푸시 알림 전송
    sendNotification(
        to = toUserId,
        title = "${currentUser.name}님이 응원을 보냈어요!",
        message = "$emoji ${habitName}",
        type = NotificationType.CHEER
    )
}
```

#### Phase 2 (나중에 추가 고려)

**가벼운 인증 추가**:
- 사진 대신 간단한 체크 메모
- "한강에서 5km 달렸어요!"
- 그룹에 공유 여부 선택 가능

**통계 중심 접근**:
- 월간 달성 캘린더
- 요일별 성공률
- 멤버 간 통계 비교

---

## 3. 그룹 권한 시스템

### 4단계 역할 체계

```kotlin
enum class GroupRole {
    OWNER,          // 그룹장
    SUB_OWNER,      // 부그룹장
    MEMBER,         // 정식 멤버
    GUEST           // 임시 멤버 (게스트)
}

data class GroupMember(
    val userId: String,
    val groupId: String,
    val role: GroupRole,
    val joinedAt: Timestamp,
    val promotedAt: Timestamp? = null,      // 승급 시간
    val promotedBy: String? = null          // 승급시킨 사람
)
```

### 역할별 상세 권한

#### 👑 OWNER (그룹장)

**모든 권한 보유**:
- ✅ 그룹 삭제
- ✅ 그룹 설정 변경
- ✅ SUB_OWNER 임명/해제
- ✅ 모든 멤버 역할 변경 (승급/강등)
- ✅ 멤버 추방
- ✅ 그룹 습관/태스크/챌린지 생성/수정/삭제
- ✅ 코인 설정 및 지급
- ✅ 소유권 이전 (그룹 탈퇴 시)

#### 🛡️ SUB_OWNER (부그룹장)

**관리 권한**:
- ✅ 그룹 습관/태스크/챌린지 생성/수정/삭제
- ✅ GUEST → MEMBER 승급
- ✅ MEMBER → GUEST 강등
- ✅ GUEST 추방
- ✅ 태스크 승인/거부
- ✅ 코인 지급 승인

**제한**:
- ⚠️ MEMBER 추방 (OWNER 승인 필요 또는 불가)
- ❌ SUB_OWNER 임명 불가
- ❌ 그룹 삭제 불가
- ❌ 그룹 설정 변경 불가 (일부만 가능)

#### 👤 MEMBER (정식 멤버)

**참여 권한**:
- ✅ 그룹 습관 참여 및 체크
- ✅ 그룹 태스크 완료
- ✅ 챌린지 참여
- ✅ 개인 습관 그룹에 공유
- ✅ 응원/댓글
- ✅ 코인 받기/주기

**제한적 생성 권한** (그룹 설정에 따라):
- ⚠️ 그룹 습관/태스크 생성 (설정에 따라 승인 필요)
- ❌ 멤버 관리 불가
- ❌ 그룹 설정 불가

#### 👻 GUEST (임시 멤버)

**구경 권한만**:
- ✅ 그룹 내용 보기
- ✅ 간단한 응원만 가능 (👏, 🔥)
- ✅ 챌린지 구경 (참여 불가)

**제한**:
- ❌ 그룹 습관 참여 불가
- ❌ 태스크 완료 불가
- ❌ 챌린지 참여 불가
- ❌ 코인 받기/주기 불가
- ❌ 댓글 불가 (응원만 가능)

**목적**: 신규 가입자 검증, 스팸 방지, 대규모 그룹 관리

### 그룹 설정

```kotlin
data class GroupSettings(
    // 권한 설정
    val maxSubOwners: Int = 5,                      // 부그룹장 최대 수
    val allowMemberCreateHabit: Boolean = true,     // 멤버의 습관 생성 허용
    val allowMemberCreateTask: Boolean = true,      // 멤버의 태스크 생성 허용
    val requireAdminApproval: Boolean = false,      // 생성 시 관리자 승인 필요
    
    // 게스트 관리
    val autoPromoteGuest: Boolean = false,          // 자동 승급 여부
    val guestPromotionDays: Int? = 7,               // 자동 승급 기간 (일)
    
    // 생성 제한
    val maxHabitsPerMember: Int? = null,            // 멤버당 습관 생성 제한
    val maxTasksPerMember: Int? = null,             // 멤버당 태스크 생성 제한
    
    // 코인 관리
    val maxCoinPerTask: Int? = null,                // 태스크당 최대 코인
    val onlyAdminCanSetCoin: Boolean = false        // 코인 설정은 관리자만
)
```

### 사용 시나리오별 설정

#### 소규모 가족 그룹 (5명)

```kotlin
GroupSettings(
    maxSubOwners = 2,
    allowMemberCreateHabit = true,      // 자유롭게 생성
    allowMemberCreateTask = true,
    requireAdminApproval = false,       // 승인 불필요
    autoPromoteGuest = true,            // 즉시 정식 멤버
    guestPromotionDays = 1
)
```

**역할 분배**:
- OWNER: 1명 (아빠)
- SUB_OWNER: 1명 (엄마)
- MEMBER: 3명 (자녀들)
- GUEST: 0명

#### 중규모 스터디 그룹 (30명)

```kotlin
GroupSettings(
    maxSubOwners = 3,
    allowMemberCreateHabit = true,
    allowMemberCreateTask = true,
    requireAdminApproval = true,        // 스팸 방지
    autoPromoteGuest = false,
    maxHabitsPerMember = 3
)
```

**역할 분배**:
- OWNER: 1명
- SUB_OWNER: 2명 (조장들)
- MEMBER: 20명
- GUEST: 7명 (청강생)

#### 대규모 운동 동호회 (100명)

```kotlin
GroupSettings(
    maxSubOwners = 5,
    allowMemberCreateHabit = false,     // 관리자만 생성
    allowMemberCreateTask = false,
    requireAdminApproval = false,
    autoPromoteGuest = false,           // 수동 승급
    onlyAdminCanSetCoin = true          // 코인 남발 방지
)
```

**역할 분배**:
- OWNER: 1명 (모임장)
- SUB_OWNER: 3명 (운영진)
- MEMBER: 40명 (정식 회원)
- GUEST: 56명 (신규/구경러)

### 멤버 관리 UI

```
[멤버 관리 화면 - SUB_OWNER 시점]
┌─────────────────────────────────────┐
│ 그룹 멤버 (100명)                     │
│                                      │
│ 👑 그룹장 (1)                         │
│   김그룹 ⭐                           │
│                                      │
│ 🛡️ 부그룹장 (3)                       │
│   이운영 🛡️                           │
│   박관리 🛡️                           │
│   최리더 🛡️                           │
│                                      │
│ 👤 정식 멤버 (40) [더보기]             │
│   홍길동 [강등] [추방]                │
│   김철수 [강등] [추방]                │
│                                      │
│ 👻 임시 멤버 (56) [더보기]             │
│   신규유저1 [승급] [추방]             │
│   구경러2 [승급] [추방]               │
└─────────────────────────────────────┘
```

### 승급 시스템

#### 수동 승급

```kotlin
fun promoteToMember(
    userId: String,
    promotedBy: String  // SUB_OWNER 또는 OWNER
) {
    // 역할 변경
    updateMemberRole(
        userId = userId,
        newRole = GroupRole.MEMBER,
        promotedBy = promotedBy,
        promotedAt = Timestamp.now()
    )
    
    // 알림 전송
    sendNotification(
        to = userId,
        title = "축하합니다! 🎉",
        message = "${groupName}의 정식 멤버가 되었습니다!",
        type = NotificationType.PROMOTION
    )
}
```

#### 자동 승급 (설정된 경우)

```kotlin
// 배치 작업 (매일 실행)
fun autoPromoteGuestsIfEnabled() {
    if (!group.settings.autoPromoteGuest) return
    
    val eligibleGuests = firestore
        .collection("groupMembers")
        .whereEqualTo("groupId", groupId)
        .whereEqualTo("role", GroupRole.GUEST)
        .get()
        .filter { member ->
            val daysSinceJoin = (Timestamp.now() - member.joinedAt).days
            daysSinceJoin >= group.settings.guestPromotionDays
        }
    
    eligibleGuests.forEach { guest ->
        promoteToMember(
            userId = guest.userId,
            promotedBy = "system"
        )
    }
}
```

#### 승급 요청 시스템 (선택적)

```kotlin
data class PromotionRequest(
    val id: String,
    val userId: String,
    val groupId: String,
    val requestedAt: Timestamp,
    val message: String?,           // 승급 요청 메시지
    val status: RequestStatus       // PENDING, APPROVED, REJECTED
)

enum class RequestStatus {
    PENDING,
    APPROVED,
    REJECTED
}
```

```
[GUEST가 참여 시도할 때]
┌─────────────────────────────────────┐
│ 🏃 아침 조깅 챌린지                   │
│                                      │
│ 목표: 30일간 매일 조깅                │
│ 보상: 10코인                          │
│                                      │
│ ⚠️ 임시 멤버는 참여할 수 없습니다      │
│                                      │
│ 정식 멤버가 되면 챌린지에 참여할 수    │
│ 있습니다. 운영진에게 승급을 요청하세요.│
│                                      │
│ [승급 요청하기]                       │
└─────────────────────────────────────┘
```

### Phase 1 구현 (간단하게)

```kotlin
// 3단계만 먼저 구현
enum class GroupRole {
    OWNER,
    MEMBER,
    GUEST
}

data class GroupMember(
    val userId: String,
    val groupId: String,
    val role: GroupRole = GroupRole.MEMBER,  // 확장 가능하게 구조 준비
    val joinedAt: Timestamp
)
```

**이유**:
- 타겟이 가족/소그룹
- MVP에서 복잡한 권한은 오버엔지니어링
- 대규모 그룹 요청 오면 그때 SUB_OWNER 추가

---

## 4. 그룹 티어 & 확장

### 그룹 인원 제한 시스템

**목적**: 코인 소비처 제공, 그룹 성장 단계화

```kotlin
enum class GroupTier(
    val maxMembers: Int,
    val upgradeCost: Int?,          // null이면 최대 티어
    val tierName: String
) {
    BASIC(
        maxMembers = 10,
        upgradeCost = 50,           // 코인
        tierName = "기본"
    ),
    STANDARD(
        maxMembers = 20,
        upgradeCost = 100,
        tierName = "스탠다드"
    ),
    PREMIUM(
        maxMembers = 50,
        upgradeCost = 200,
        tierName = "프리미엄"
    ),
    UNLIMITED(
        maxMembers = Int.MAX_VALUE,
        upgradeCost = null,
        tierName = "무제한"
    )
}

data class Group(
    val id: String,
    val name: String,
    val type: GroupType,
    val ownerId: String,
    val tier: GroupTier = GroupTier.BASIC,
    val currentMemberCount: Int,
    val settings: GroupSettings,
    val createdAt: Timestamp,
    val updatedAt: Timestamp
)
```

### 티어별 혜택

```kotlin
data class TierBenefits(
    val tier: GroupTier,
    val maxMembers: Int,
    val maxSubOwners: Int,
    val maxHabits: Int,                 // 동시 진행 그룹 습관 수
    val maxChallenges: Int,             // 동시 진행 챌린지 수
    val canCustomizeTheme: Boolean,     // 그룹 테마 커스터마이징
    val storageForPhotos: Int           // 사진 저장 용량 (MB)
) {
    companion object {
        fun fromTier(tier: GroupTier) = when (tier) {
            GroupTier.BASIC -> TierBenefits(
                tier = tier,
                maxMembers = 10,
                maxSubOwners = 1,
                maxHabits = 5,
                maxChallenges = 3,
                canCustomizeTheme = false,
                storageForPhotos = 50
            )
            GroupTier.STANDARD -> TierBenefits(
                tier = tier,
                maxMembers = 20,
                maxSubOwners = 2,
                maxHabits = 10,
                maxChallenges = 5,
                canCustomizeTheme = false,
                storageForPhotos = 100
            )
            GroupTier.PREMIUM -> TierBenefits(
                tier = tier,
                maxMembers = 50,
                maxSubOwners = 5,
                maxHabits = 20,
                maxChallenges = 10,
                canCustomizeTheme = true,
                storageForPhotos = 500
            )
            GroupTier.UNLIMITED -> TierBenefits(
                tier = tier,
                maxMembers = Int.MAX_VALUE,
                maxSubOwners = 10,
                maxHabits = Int.MAX_VALUE,
                maxChallenges = Int.MAX_VALUE,
                canCustomizeTheme = true,
                storageForPhotos = 2000
            )
        }
    }
}
```

### 티어 비교표

| 티어 | 최대 인원 | 업그레이드 비용 | 부그룹장 | 동시 습관 | 동시 챌린지 | 사진 저장 | 테마 커스터마이징 |
|------|----------|---------------|---------|----------|-----------|----------|----------------|
| 기본 | 10명 | - | 1명 | 5개 | 3개 | 50MB | ❌ |
| 스탠다드 | 20명 | 50코인 | 2명 | 10개 | 5개 | 100MB | ❌ |
| 프리미엄 | 50명 | 100코인 | 5명 | 20개 | 10개 | 500MB | ✅ |
| 무제한 | 무제한 | 200코인 | 10명 | 무제한 | 무제한 | 2GB | ✅ |

### 업그레이드 UI

```
[그룹 설정 - 업그레이드 섹션]
┌─────────────────────────────────────┐
│ 그룹 티어 업그레이드                  │
│                                      │
│ 현재 티어: 기본 (10명)                │
│ 현재 멤버: 9/10명 ⚠️                  │
│                                      │
│ ┌─────────────────────────────────┐ │
│ │ 스탠다드 티어로 업그레이드          │ │
│ │                                  │ │
│ │ 💎 50코인                         │ │
│ │                                  │ │
│ │ 혜택:                             │ │
│ │ ✅ 최대 20명까지 초대              │ │
│ │ ✅ 부그룹장 2명까지                │ │
│ │ ✅ 동시 진행 습관 10개             │ │
│ │ ✅ 동시 진행 챌린지 5개            │ │
│ │ ✅ 사진 저장 100MB                │ │
│ │                                  │ │
│ │ [업그레이드하기]                  │ │
│ └─────────────────────────────────┘ │
│                                      │
│ 내 코인: 120 💰                       │
│                                      │
│ [전체 티어 비교 보기]                │
└─────────────────────────────────────┘
```

### 멤버 제한 도달 시

```
[신규 멤버 초대 시도]
┌─────────────────────────────────────┐
│ ⚠️ 그룹 인원이 가득 찼습니다           │
│                                      │
│ 현재: 10/10명 (기본 티어)             │
│                                      │
│ 더 많은 멤버를 초대하려면              │
│ 그룹을 업그레이드하세요!              │
│                                      │
│ [스탠다드로 업그레이드] (50코인)      │
│ [나중에]                             │
└─────────────────────────────────────┘
```

### 업그레이드 로직

```kotlin
suspend fun upgradeGroupTier(
    groupId: String,
    newTier: GroupTier,
    payerId: String  // 결제하는 사람 (OWNER)
): Result<Unit> {
    val group = getGroup(groupId)
    val payer = getUser(payerId)
    
    // 1. 권한 확인
    if (group.ownerId != payerId) {
        return Result.failure(Exception("그룹장만 업그레이드할 수 있습니다"))
    }
    
    // 2. 티어 순서 확인
    if (newTier.ordinal <= group.tier.ordinal) {
        return Result.failure(Exception("이미 더 높은 티어입니다"))
    }
    
    // 3. 코인 확인
    val cost = group.tier.upgradeCost ?: return Result.failure(Exception("최대 티어입니다"))
    if (payer.wallet.totalCoins < cost) {
        return Result.failure(Exception("코인이 부족합니다"))
    }
    
    // 4. 트랜잭션 실행
    return firestore.runTransaction { transaction ->
        // 코인 차감
        transaction.update(
            userWalletRef(payerId),
            "rewardCoins", FieldValue.increment(-cost)
        )
        
        // 코인 거래 기록
        transaction.set(
            coinTransactionRef(),
            CoinTransaction(
                fromUserId = payerId,
                toUserId = "system",
                amount = cost,
                type = TransactionType.TIER_UPGRADE,
                relatedGroupId = groupId
            )
        )
        
        // 그룹 티어 변경
        transaction.update(
            groupRef(groupId),
            "tier", newTier,
            "updatedAt", Timestamp.now()
        )
        
        Result.success(Unit)
    }.addOnSuccessListener {
        // 그룹 전체에 알림
        sendGroupNotification(
            groupId = groupId,
            title = "그룹이 업그레이드되었습니다! 🎉",
            message = "${newTier.tierName} 티어로 업그레이드되어 더 많은 기능을 사용할 수 있습니다."
        )
    }
}
```

---

## 5. 그룹 통계 시스템

### 기존 문제점
- 현재: 개인 통계만 존재
- 그룹 활동에 대한 인사이트 부족
- 그룹원 간 비교 불가
- 그룹 성과 확인 어려움

### 새로운 그룹 통계

```kotlin
data class GroupStatistics(
    val groupId: String,
    val period: StatisticsPeriod,
    
    // 전체 그룹 집계
    val totalHabitsCompleted: Int,
    val totalTasksCompleted: Int,
    val totalChallengesCompleted: Int,
    val totalCoinsEarned: Int,
    val totalCoinsSpent: Int,
    
    // 평균 지표
    val avgCompletionRate: Double,
    val avgStreakDays: Double,
    val activeMemberCount: Int,
    val activeMemberRate: Double,
    
    // 멤버 랭킹
    val topContributors: List<MemberRank>,          // MVP
    val longestStreaks: List<StreakRank>,           // 최장 연속
    val mostActiveMembers: List<ActivityRank>,      // 활동량
    
    // 습관별 통계
    val popularHabits: List<HabitStats>,            // 인기 습관
    val challengeSuccessRate: Map<String, Double>,  // 챌린지 성공률
    
    // 활동 패턴 분석
    val activityByDayOfWeek: Map<DayOfWeek, Int>,  // 요일별
    val activityByHour: Map<Int, Int>,              // 시간대별
    
    val generatedAt: Timestamp
)

enum class StatisticsPeriod {
    DAILY,      // 오늘
    WEEKLY,     // 이번 주
    MONTHLY,    // 이번 달
    ALL_TIME    // 전체 기간
}

// 멤버 랭킹
data class MemberRank(
    val userId: String,
    val userName: String,
    val userAvatar: String?,
    val score: Int,                 // 완료 횟수
    val rank: Int
)

// 연속 기록 랭킹
data class StreakRank(
    val userId: String,
    val userName: String,
    val habitName: String,
    val streakDays: Int,
    val rank: Int
)

// 활동량 랭킹
data class ActivityRank(
    val userId: String,
    val userName: String,
    val completionCount: Int,
    val participationRate: Double,  // 참여율
    val rank: Int
)

// 습관별 통계
data class HabitStats(
    val habitId: String,
    val habitName: String,
    val participantCount: Int,      // 참여 인원
    val totalCompletions: Int,      // 총 완료 횟수
    val avgCompletionRate: Double   // 평균 달성률
)
```

### 통계 UI

#### 메인 대시보드

```
[그룹 통계 화면]
┌─────────────────────────────────────┐
│ 📊 그룹 통계                          │
│                                      │
│ [이번 주 ▼]                           │
│                                      │
│ ┌─────────────────────────────────┐ │
│ │ 그룹 활동 요약                    │ │
│ │                                  │ │
│ │ 🎯 완료된 습관: 245회             │ │
│ │ ✅ 완료된 할일: 89개              │ │
│ │ 🏆 달성한 챌린지: 3개             │ │
│ │ 💰 획득한 코인: 1,240             │ │
│ │                                  │ │
│ │ 활동 멤버: 8/10명 (80%)          │ │
│ │ 평균 달성률: 73%                  │ │
│ │ 평균 연속 기록: 8일               │ │
│ └─────────────────────────────────┘ │
│                                      │
│ ┌─────────────────────────────────┐ │
│ │ 🏅 이번 주 MVP                    │ │
│ │                                  │ │
│ │ 1위 👑 김철수                     │ │
│ │    습관 45회 완료 | 달성률 90%    │ │
│ │                                  │ │
│ │ 2위 🥈 이영희                     │ │
│ │    습관 38회 완료 | 달성률 85%    │ │
│ │                                  │ │
│ │ 3위 🥉 박민수                     │ │
│ │    습관 32회 완료 | 달성률 78%    │ │
│ └─────────────────────────────────┘ │
│                                      │
│ ┌─────────────────────────────────┐ │
│ │ 🔥 최장 연속 기록                 │ │
│ │                                  │ │
│ │ 1. 이영희 - 아침 운동 (42일) 🔥  │ │
│ │ 2. 김철수 - 독서 (28일)          │ │
│ │ 3. 박민수 - 물 마시기 (21일)     │ │
│ └─────────────────────────────────┘ │
│                                      │
│ [더 자세한 통계 보기]                │
└─────────────────────────────────────┘
```

#### 상세 통계 화면 (탭 구성)

**[개요] 탭**:
```
┌─────────────────────────────────────┐
│ 그룹 성과 (이번 주)                   │
│                                      │
│ 완료율 추이                           │
│ [꺾은선 그래프]                       │
│ 월 ● 화 ● 수 ● 목 ● 금 ● 토 ● 일    │
│ 78% 65% 82% 71% 80% 45% 62%         │
│                                      │
│ 가장 활발한 요일: 수요일 🎉           │
│ 가장 저조한 요일: 토요일              │
│                                      │
│ 코인 획득 추이                        │
│ [막대 그래프]                         │
│ 월 █████ 180                         │
│ 화 ████ 145                          │
│ 수 ██████ 230                        │
│ ...                                  │
└─────────────────────────────────────┘
```

**[멤버] 탭**:
```
┌─────────────────────────────────────┐
│ 멤버 활동 랭킹                        │
│                                      │
│ 1위 👑 김철수                         │
│    완료: 45회 | 달성률: 90%           │
│    연속: 15일 | 코인: 125             │
│    [프로필 보기]                      │
│                                      │
│ 2위 🥈 이영희                         │
│    완료: 38회 | 달성률: 85%           │
│    연속: 42일 🔥 | 코인: 98           │
│    [프로필 보기]                      │
│                                      │
│ 3위 🥉 박민수                         │
│    완료: 32회 | 달성률: 78%           │
│    연속: 21일 | 코인: 87              │
│    [프로필 보기]                      │
│                                      │
│ ... (더보기)                          │
└─────────────────────────────────────┘
```

**[습관] 탭**:
```
┌─────────────────────────────────────┐
│ 인기 습관 TOP 5                       │
│                                      │
│ 🏃 아침 운동                          │
│    참여: 8명 (80%)                    │
│    완료: 156회                        │
│    평균 달성률: 78%                   │
│    [상세 보기]                        │
│                                      │
│ 📚 독서하기                           │
│    참여: 6명 (60%)                    │
│    완료: 98회                         │
│    평균 달성률: 65%                   │
│    [상세 보기]                        │
│                                      │
│ 💧 물 2L 마시기                       │
│    참여: 9명 (90%)                    │
│    완료: 189회                        │
│    평균 달성률: 84%                   │
│    [상세 보기]                        │
│                                      │
│ ... (더보기)                          │
└─────────────────────────────────────┘
```

**[활동 패턴] 탭**:
```
┌─────────────────────────────────────┐
│ 요일별 활동 분석                      │
│                                      │
│ [막대 차트]                           │
│ 월: ████████ 45회                    │
│ 화: ██████ 32회                      │
│ 수: ██████████ 58회                  │
│ 목: ████████ 43회                    │
│ 금: ██████ 35회                      │
│ 토: ████ 21회                        │
│ 일: ███ 18회                         │
│                                      │
│ 📊 인사이트:                          │
│ • 평일(월-금) 평균: 42.6회           │
│ • 주말(토-일) 평균: 19.5회           │
│ • 수요일이 가장 활발해요!            │
│                                      │
│ ──────────────────────────────────  │
│                                      │
│ 시간대별 활동 분석                    │
│                                      │
│ [시간대별 히트맵]                     │
│ 06:00 ████                           │
│ 07:00 ██████████                     │
│ 08:00 ████████                       │
│ 12:00 ████                           │
│ 18:00 ██████                         │
│ 22:00 ████████                       │
│                                      │
│ 가장 활발한 시간: 오전 7시            │
└─────────────────────────────────────┘
```

#### 개인 vs 그룹 비교

```
[내 통계 탭]
┌─────────────────────────────────────┐
│ 내 활동 vs 그룹 평균                  │
│                                      │
│ 이번 주 완료율                        │
│ 나:   ████████████ 85%               │
│ 평균: ██████████ 73%                 │
│ 👍 그룹 평균보다 12% 높아요!          │
│                                      │
│ 최장 연속 기록                        │
│ 나:   15일 🔥                         │
│ 평균: 8일                             │
│ 💪 그룹에서 상위 20%에요!             │
│                                      │
│ 획득한 코인                           │
│ 나:   125 💰                          │
│ 평균: 98 💰                           │
│ 💎 그룹 평균보다 27코인 더 많아요!    │
│                                      │
│ 내 랭킹                               │
│ 전체: 3위 / 10명                      │
│ 이번 주: 2위 🥈                       │
│                                      │
│ [더 열심히 하기!]                     │
└─────────────────────────────────────┘
```

### 통계 생성 로직

```kotlin
class GroupStatisticsService @Inject constructor(
    private val firestore: FirebaseFirestore
) {
    
    suspend fun calculateGroupStats(
        groupId: String,
        period: StatisticsPeriod
    ): GroupStatistics {
        val (startDate, endDate) = period.getDateRange()
        
        // 1. 기본 집계 데이터 수집
        val habits = getCompletedHabits(groupId, startDate, endDate)
        val tasks = getCompletedTasks(groupId, startDate, endDate)
        val challenges = getCompletedChallenges(groupId, startDate, endDate)
        val coins = getCoinTransactions(groupId, startDate, endDate)
        
        // 2. 멤버별 활동 계산
        val memberActivities = calculateMemberActivities(
            groupId, habits, tasks, challenges
        )
        
        // 3. 랭킹 생성
        val topContributors = memberActivities
            .sortedByDescending { it.totalCompletions }
            .take(10)
            .mapIndexed { index, member -> 
                MemberRank(
                    userId = member.userId,
                    userName = member.userName,
                    userAvatar = member.avatar,
                    score = member.totalCompletions,
                    rank = index + 1
                )
            }
        
        // 4. 연속 기록 랭킹
        val longestStreaks = calculateStreakRankings(groupId)
            .sortedByDescending { it.streakDays }
            .take(10)
        
        // 5. 활동량 랭킹
        val mostActiveMembers = memberActivities
            .sortedByDescending { it.participationRate }
            .take(10)
            .mapIndexed { index, member ->
                ActivityRank(
                    userId = member.userId,
                    userName = member.userName,
                    completionCount = member.totalCompletions,
                    participationRate = member.participationRate,
                    rank = index + 1
                )
            }
        
        // 6. 습관별 통계
        val habitStats = calculateHabitStatistics(groupId, startDate, endDate)
            .sortedByDescending { it.participantCount }
        
        // 7. 챌린지 성공률
        val challengeSuccessRate = calculateChallengeSuccessRates(
            groupId, startDate, endDate
        )
        
        // 8. 활동 패턴 분석
        val activityByDay = analyzeActivityByDayOfWeek(habits, tasks)
        val activityByHour = analyzeActivityByHour(habits, tasks)
        
        return GroupStatistics(
            groupId = groupId,
            period = period,
            totalHabitsCompleted = habits.size,
            totalTasksCompleted = tasks.size,
            totalChallengesCompleted = challenges.size,
            totalCoinsEarned = coins.filter { it.amount > 0 }.sumOf { it.amount },
            totalCoinsSpent = coins.filter { it.amount < 0 }.sumOf { -it.amount },
            avgCompletionRate = calculateAvgCompletionRate(memberActivities),
            avgStreakDays = calculateAvgStreakDays(groupId),
            activeMemberCount = memberActivities.count { it.isActive },
            activeMemberRate = memberActivities.count { it.isActive }.toDouble() / 
                              memberActivities.size,
            topContributors = topContributors,
            longestStreaks = longestStreaks,
            mostActiveMembers = mostActiveMembers,
            popularHabits = habitStats,
            challengeSuccessRate = challengeSuccessRate,
            activityByDayOfWeek = activityByDay,
            activityByHour = activityByHour,
            generatedAt = Timestamp.now()
        )
    }
    
    private fun StatisticsPeriod.getDateRange(): Pair<Timestamp, Timestamp> {
        val now = Calendar.getInstance()
        return when (this) {
            StatisticsPeriod.DAILY -> {
                val start = now.apply { 
                    set(Calendar.HOUR_OF_DAY, 0)
                    set(Calendar.MINUTE, 0)
                    set(Calendar.SECOND, 0)
                }
                val end = now.apply {
                    set(Calendar.HOUR_OF_DAY, 23)
                    set(Calendar.MINUTE, 59)
                    set(Calendar.SECOND, 59)
                }
                Pair(Timestamp(start.time), Timestamp(end.time))
            }
            StatisticsPeriod.WEEKLY -> {
                val start = now.apply {
                    set(Calendar.DAY_OF_WEEK, Calendar.MONDAY)
                    set(Calendar.HOUR_OF_DAY, 0)
                    set(Calendar.MINUTE, 0)
                }
                val end = now.apply {
                    set(Calendar.DAY_OF_WEEK, Calendar.SUNDAY)
                    set(Calendar.HOUR_OF_DAY, 23)
                    set(Calendar.MINUTE, 59)
                }
                Pair(Timestamp(start.time), Timestamp(end.time))
            }
            StatisticsPeriod.MONTHLY -> {
                val start = now.apply {
                    set(Calendar.DAY_OF_MONTH, 1)
                    set(Calendar.HOUR_OF_DAY, 0)
                    set(Calendar.MINUTE, 0)
                }
                val end = now.apply {
                    set(Calendar.DAY_OF_MONTH, getActualMaximum(Calendar.DAY_OF_MONTH))
                    set(Calendar.HOUR_OF_DAY, 23)
                    set(Calendar.MINUTE, 59)
                }
                Pair(Timestamp(start.time), Timestamp(end.time))
            }
            StatisticsPeriod.ALL_TIME -> {
                Pair(Timestamp(0, 0), Timestamp.now())
            }
        }
    }
    
    private suspend fun calculateHabitStatistics(
        groupId: String,
        startDate: Timestamp,
        endDate: Timestamp
    ): List<HabitStats> {
        // 그룹 습관 목록 가져오기
        val groupHabits = firestore
            .collection("habits")
            .whereEqualTo("groupId", groupId)
            .get()
            .await()
        
        return groupHabits.documents.map { doc ->
            val habit = doc.toObject<Habit>()!!
            val completions = getHabitCompletions(habit.id, startDate, endDate)
            val participants = completions.map { it.userId }.distinct()
            
            HabitStats(
                habitId = habit.id,
                habitName = habit.title,
                participantCount = participants.size,
                totalCompletions = completions.size,
                avgCompletionRate = calculateCompletionRate(habit, completions)
            )
        }
    }
}
```

### 통계 캐싱

```kotlin
// 성능 최적화를 위한 캐싱
data class CachedGroupStatistics(
    val statistics: GroupStatistics,
    val cachedAt: Timestamp,
    val expiresAt: Timestamp
)

class GroupStatisticsCache {
    private val cache = mutableMapOf<String, CachedGroupStatistics>()
    
    fun get(groupId: String, period: StatisticsPeriod): GroupStatistics? {
        val key = "${groupId}_${period}"
        val cached = cache[key] ?: return null
        
        if (Timestamp.now() > cached.expiresAt) {
            cache.remove(key)
            return null
        }
        
        return cached.statistics
    }
    
    fun put(groupId: String, period: StatisticsPeriod, stats: GroupStatistics) {
        val key = "${groupId}_${period}"
        val expiresAt = when (period) {
            StatisticsPeriod.DAILY -> Timestamp.now() + 1.hours
            StatisticsPeriod.WEEKLY -> Timestamp.now() + 6.hours
            StatisticsPeriod.MONTHLY -> Timestamp.now() + 24.hours
            StatisticsPeriod.ALL_TIME -> Timestamp.now() + 24.hours
        }
        
        cache[key] = CachedGroupStatistics(
            statistics = stats,
            cachedAt = Timestamp.now(),
            expiresAt = expiresAt
        )
    }
}
```

---

## 6. 구현 우선순위

### Phase 1: MVP 완성 (지금 구현)

#### 1. 코인 시스템 기본
- ✅ 코인 지갑 (Firestore 구조)
- ✅ 코인 거래 내역
- ✅ 습관 7일 연속 → 1코인 자동 지급
- ✅ 태스크에 코인 설정
- ✅ 그룹원끼리 코인 주고받기
- ✅ 기본 UI (잔액, 내역)

#### 2. 습관 구조 개편
- ✅ 그룹원 습관 섹션 추가
- ✅ 개인 습관에 "그룹 공유" 토글
- ✅ 공유된 습관만 그룹에서 보이기
- ✅ 간단한 응원 기능 (이모지 + 푸시 알림)

#### 3. 그룹 권한 (간단하게)
- ✅ OWNER / MEMBER / GUEST 3단계만
- ✅ 기본 권한 체크
- ✅ 데이터 구조는 확장 가능하게

#### 4. 그룹 티어
- ✅ BASIC / STANDARD 2단계만
- ✅ 코인으로 업그레이드
- ✅ 멤버 수 제한
- ✅ 업그레이드 UI

#### 5. 그룹 통계 (기본)
- ✅ 완료 횟수 집계
- ✅ MVP 랭킹 (Top 3)
- ✅ 최장 연속 기록
- ✅ 간단한 대시보드

**예상 개발 기간**: 2-3주

---

### Phase 2: 확장 (사용자 반응 보고)

#### 1. 코인 시스템 확장
- 리워드 광고 통합 (AdMob)
- 간단한 인앱 리워드
    - 프로필 꾸미기
    - 그룹 테마
    - 특별 이모티콘
- 소액 쿠폰 제휴 (테스트)

#### 2. 습관 상호작용 강화
- 체크 시 메모 기능
- 월간 달성 캘린더 뷰
- 응원 누적 표시
- 습관별 상세 통계

#### 3. 그룹 권한 확장
- SUB_OWNER 역할 추가
- 승인 시스템
    - 태스크 생성 승인
    - 코인 지급 승인
    - 멤버 승급 요청
- 세밀한 권한 설정

#### 4. 그룹 티어 확장
- PREMIUM / UNLIMITED 추가
- 티어별 추가 혜택
    - 동시 습관 수 증가
    - 사진 저장 용량
    - 그룹 테마 커스터마이징
    - 우선 고객 지원

#### 5. 상세 그룹 통계
- 활동 패턴 분석
    - 요일별 그래프
    - 시간대별 히트맵
- 멤버별 상세 비교
- 습관별 성공률
- 인사이트 제공

**예상 개발 기간**: 3-4주

---

### Phase 3: 수익화 & 고도화 (장기)

#### 1. 코인 시스템 완성
- 코인 충전 (실제 결제)
    - 구글 인앱 결제 연동
    - 결제 패키지 설계
- 주요 브랜드 쿠폰 제휴
    - 치킨, 커피, 영화
    - API 연동
- 환전 시스템

#### 2. 그룹 챌린지 시스템
- 챌린지 유형
    - 전원 달성형
    - 개인 경쟁형
    - 랭킹형
- 챌린지 생성 UI
- 참가비 & 보상 풀
- 진행률 추적
- 결과 정산

#### 3. 사진 인증 & 소셜
- 사진 업로드
- 압축 & 최적화
- 댓글 시스템
- 좋아요 기능
- 피드 타임라인

#### 4. 고급 통계 & 리포트
- PDF 보고서 생성
    - 주간 리포트
    - 월간 리포트
- 예측 기능
    - 다음 주 목표 추천
    - 달성 가능성 예측
- AI 기반 습관 추천
- 그룹 건강도 분석

#### 5. 고급 알림 시스템
- 스마트 리마인더
- 그룹 활동 요약
- 성과 축하 메시지
- 동기부여 메시지

**예상 개발 기간**: 6-8주

---

## 핵심 설계 원칙

### 1. 단계적 구현
- 복잡한 기능은 나중에
- 지금은 핵심 가치에 집중
- 사용자 피드백 기반 개선

### 2. 확장 가능한 구조
- 데이터 모델은 미래를 고려
- 새 필드 추가는 쉽게
- 타입 변경은 DTO에서만

### 3. 사용자 중심
- 타겟: 가족/소그룹
- 과한 기능보다 단순함
- 직관적인 UX

### 4. 실생활 연계
- "디지털 용돈" 콘셉트
- 일상의 루틴과 통합
- 실질적 보상 제공

### 5. 프라이버시 존중
- 공유는 선택
- 강제하지 않음
- 개인 영역 보장

### 6. 성능 고려
- 통계는 캐싱
- 대규모 그룹 대비
- 오프라인 동작

### 7. 안정성 우선
- 단계별 테스트
- 점진적 롤아웃
- 롤백 가능한 구조

---

## 기술 스택

### 데이터베이스
- **Firebase Firestore**: 실시간 동기화, NoSQL
- **컬렉션 구조**:
    - `users/{userId}`
    - `groups/{groupId}`
    - `groupMembers/{memberId}`
    - `habits/{habitId}`
    - `tasks/{taskId}`
    - `coinWallets/{userId}`
    - `coinTransactions/{transactionId}`
    - `groupStatistics/{groupId}/{period}`

### 백엔드
- **Firebase Functions**: 자동화 작업
    - 코인 자동 지급 (습관 연속 달성)
    - 통계 생성 배치
    - 게스트 자동 승급
    - 리마인더 발송

### 푸시 알림
- **Firebase Cloud Messaging (FCM)**
    - 응원 알림
    - 코인 지급 알림
    - 멤버 활동 알림
    - 챌린지 관련 알림

### UI
- **Jetpack Compose**: 선언적 UI
- **Material Design 3**: 디자인 시스템
- **Warm Orange Theme**: 브랜드 컬러

### 아키텍처
- **Clean Architecture**: 계층 분리
- **MVVM Pattern**: ViewModel + State
- **Repository Pattern**: 데이터 추상화
- **Hilt**: 의존성 주입

---

## 마이그레이션 전략

### 기존 사용자 대응

#### 1. 그룹 데이터
```kotlin
// 모든 기존 그룹을 BASIC 티어로 설정
fun migrateExistingGroups() {
    firestore.collection("groups")
        .get()
        .await()
        .forEach { doc ->
            doc.reference.update(
                "tier", GroupTier.BASIC,
                "currentMemberCount", doc.get("memberCount")
            )
        }
}
```

#### 2. 멤버 역할
```kotlin
// 기존 멤버들을 MEMBER로 설정
fun migrateMemberRoles() {
    firestore.collection("groupMembers")
        .get()
        .await()
        .forEach { doc ->
            val isOwner = doc.getBoolean("isOwner") ?: false
            doc.reference.update(
                "role", if (isOwner) GroupRole.OWNER else GroupRole.MEMBER
            )
        }
}
```

#### 3. 코인 지갑
```kotlin
// 모든 사용자에게 코인 지갑 생성
fun createCoinWallets() {
    firestore.collection("users")
        .get()
        .await()
        .forEach { doc ->
            val userId = doc.id
            firestore.collection("coinWallets")
                .document(userId)
                .set(CoinWallet(
                    userId = userId,
                    familyCoins = 0,
                    rewardCoins = 0,
                    totalEarned = 0,
                    totalSpent = 0,
                    lastUpdated = Timestamp.now()
                ))
        }
}
```

### 점진적 롤아웃
1. **베타 테스트**: 소수 사용자 대상 테스트
2. **A/B 테스트**: 기능별 효과 측정
3. **단계적 출시**: 지역/그룹별 순차 적용
4. **모니터링**: 실시간 에러 추적 및 대응

---

## 성공 지표 (KPI)

### Phase 1 목표
- 코인 거래 활성화율: 60% 이상
- 그룹원 습관 조회율: 40% 이상
- 응원 기능 사용률: 50% 이상
- 그룹 통계 조회율: 70% 이상

### Phase 2 목표
- 그룹 티어 업그레이드율: 20% 이상
- 광고 시청률: 30% 이상
- SUB_OWNER 활용률: 50% 이상
- 챌린지 참여율: 60% 이상

### Phase 3 목표
- 코인 충전 전환율: 10% 이상
- 쿠폰 교환율: 15% 이상
- 월간 활성 사용자 유지율: 80% 이상
- 추천을 통한 신규 유입: 30% 이상

---

## 리스크 & 대응 방안

### 1. 코인 경제 밸런스
**리스크**: 코인 인플레이션, 남발
**대응**:
- 획득/사용 데이터 모니터링
- 주기적인 밸런스 조정
- 관리자 권한으로 코인 제어

### 2. 대규모 그룹 성능
**리스크**: 100명 이상 그룹에서 속도 저하
**대응**:
- 페이지네이션
- 통계 캐싱
- 백그라운드 작업

### 3. 스팸/어뷰징
**리스크**: 코인 어뷰징, 스팸 그룹
**대응**:
- GUEST 시스템으로 진입 장벽
- 신고 기능
- 자동 감지 시스템

### 4. 개발 일정
**리스크**: 기능 과다로 일정 지연
**대응**:
- Phase 1에 집중
- MVP 먼저 출시
- 점진적 기능 추가

---

## 다음 단계

1. **Phase 1 개발 착수**
    - 코인 시스템 데이터 구조 구현
    - 그룹원 습관 UI 개발
    - 기본 권한 시스템 구현

2. **테스트 계획 수립**
    - 단위 테스트
    - 통합 테스트
    - 사용자 수용 테스트

3. **베타 테스트 준비**
    - 테스트 그룹 모집
    - 피드백 수집 계획
    - 개선 사이클 설계

4. **문서화**
    - API 문서
    - 사용자 가이드
    - 운영 매뉴얼